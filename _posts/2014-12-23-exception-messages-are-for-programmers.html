---
layout: post
title: "Exception messages are for programmers"
date: 2014-12-23 8:24 UTC
tags: [Software Design]
---
{% include JB/setup %}

<div id="post">
  <p>
    <em>Exception messages should be aimed at other developers, not end users.</em>
  </p>
  <p>
    Once in a while, I come across fellow programmers with uncertain understanding of the purpose of exception messages. In my experience, when it comes to writing exception messages, most developers approach the job with one of these mindsets:
    <ul>
      <li>Write the shortest possible exception message; if possible, ignore good grammar, punctuation, and proper spelling.</li>
      <li>Write lovingly crafted error messages for the end users.</li>
    </ul>
    Both approaches are wrong.
  </p>
  <p>
    <strong>Damn the torpedoes</strong>
  </p>
  <p>
    As far as I can tell, the most common approach to writing error messages is to get it over with as quickly as possible. Apparently, writing a good exception message is such tedious work that a developer can't possibly be bothered with it. Here are some examples:
  </p>
  <p>
    <pre style="font-family:Consolas;font-size:13;color:black;"><span style="color:blue;">throw</span>&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">Exception</span>(<span style="color:#a31515;">&quot;Unknown&nbsp;FaileType&quot;</span>);
</pre>
  </p>
  <p>
    or:
  </p>
  <p>
    <pre style="font-family:Consolas;font-size:13;color:black;"><span style="color:blue;">throw</span>&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">Exception</span>(<span style="color:#a31515;">&quot;Unecpected&nbsp;workingDirectory&quot;</span>);
</pre>
  </p>
  <p>
    These aren't particularly helpful. At the very least, is it too much to ask that they apply correct spelling and punctuation? Would it have been a horrible experience for the developer to write "Unknown FailureType.", or "Unexpected workingDirectory."?
  </p>
  <p>
    Even if spelling, grammar, and punctuation are corrected, these exception messages aren't particularly helpful to anyone. Fair enough that the FailureType or workingDirectory values were unknown or unexpected, but what <em>were</em> they, then?
  </p>
  <p>
    If you're seeing such exceptions while working with the code in your IDE, you may be able to attach a debugger and figure out what was the wrong value, but if you're looking at an error log from a production system, you'd really like to know the exact value that was unexpected.
  </p>
  <p>
    Unfortunately, most developers apparently can't be bothered with supplying even such rudimentary information.
  </p>
  <p>
    <strong>Exception messages for end users?</strong>
  </p>
  <p>
    Developers who <em>do</em> care about exception messages often seem to have end users in mind. They may spell exception messages correctly, but shy away from providing technical information in the messages, because they are considering the user experience for the end users. They would argue that the "Unknown FailureType" shouldn't be included in the exception message, because it's too technical.
  </p>
  <p>
    It is, indeed, too technical for end users, but the misconception here is that exception messages should be exposed to end users at all. These developers seems to have a plan for exception handling, which essentially involves catching all exceptions at the boundary of the application, and simply show the exception message to the end user.
  </p>
  <p>
    That's unlikely to provide a good user experience.
  </p>
  <p>
    It should be clear that "Unknown FailureType." isn't particularly helpful to a fellow programmer, but it's even more useless to a non-technical end user. Thus, in an effort to shield end users from the technical failure modes of our program, we make exception messages useless to end users and fellow programmers alike.
  </p>
  <p>
    <strong>Security</strong>
  </p>
  <p>
    Another argument I often encounter is one of security - in this case Information Disclosure. According to the argument, exception messages shouldn't include run-time values, because that may leak information about how the system works. Again, this argument seems to hinge on the implied usage of exception messages shown to end users.
  </p>
  <p>
    <strong>Language</strong>
  </p>
  <p>
    Exception messages aren't for end users. End users don't speak your language. They don't speak 'Technical'. They may not even speak English. What if your target demographic is all Dutch? Are you going to write all of your exception messages in Dutch? Even if you do, what about exceptions thrown by your Base Class Library or third-party libraries? These are likely to be in English, so if you catch and display all exceptions, you may occasionally display an English message to your Dutch users.
  </p>
  <p>
    What if your application is designed for a Swiss audience? In which language are you going to write your exception messages? German? French? Italian? Romansh?
  </p>
  <p>
    <strong>Conceptual coupling</strong>
  </p>
  <p>
    All of the above arguments even implicitly assume that you're writing exception messages for a known system. What if you're writing a reusable library? If you're writing a reusable library, you don't know the context in which it's going to be used. If you don't know the context, then how can you write an appropriate message for an end user?
  </p>
  <p>
    It should be clear that when writing a reusable library, you're unlikely to know the <em>language</em> of the end user, but it's worse than that: you don't know <em>anything</em> about the end user. You don't even know if there's going to be an end user at all; your library may as well be running inside a batch job.
  </p>
  <p>
    The converse is true as well. Even if you aren't writing a reusable library, end user-targeted exception messages <em>increases the coupling</em> in the system, because exception messages would be coupled to a particular user interface. This sort of coupling doesn't occur in the type system, but is conceptual. Exactly because it's not tied to any type system, an automated tool can't detect it, so it's much harder to notice, and more insidious as a result.
  </p>
  <p>
    Exception messages are not for end users. Applications can catch known exception <em>types</em> and translate them to context-aware error messages, but this is a user interface concern - not a technical concern.
  </p>
  <p>
    <strong>Exception messages for client developers</strong>
  </p>
  <p>
    Now that you understand that exception messages shouldn't be aimed at end users, who's left? Your fellow programmers, including your future self. As I explain in <a href="http://www.shareasale.com/r.cfm?u=1017843&b=611266&m=53701&afftrack=&urllink=www%2Epluralsight%2Ecom%2Fcourses%2Fencapsulation%2Dsolid">my encapsulation course</a>, exception messages can be used as documentation of the system.
  </p>
  <p>
    Imagine that you're using a new library that you don't yet know well. Which exception message would you, as a programmer, prefer to encounter?
    <blockquote>
      "Unecpected workingDirectory"
    </blockquote>
    or this:
    <blockquote>
      <p>
        "You tried to provide a working directory string that doesn't represent a working directory. It's not your fault, because it wasn't possible to design the FileStore class in such a way that this is a statically typed pre-condition, but please supply a valid path to an existing directory.
      </p>
      <p>
        "The invalid value was: "fllobdedy"."
      </p>
    </blockquote>
    How do those two messages make you feel?
  </p>
  <p>
    The first type of exception message often make me feel that I suck. The second is mostly an annoyance that my program doesn't work, followed by delight that the object I'm using makes it easy for me to <em>solve my problem</em>.
  </p>
  <p>    
    If you encounter the first exception message, you'll often need to attach a debugger to figure out what was wrong, or at least open the offending code to understand what made it fail. In the second example, the object you're using does its best to provide you with all the information you need in order to solve the problem.
  </p>
  <p>
    <strong>Call to action</strong>
  </p>
  <p>
    Do write useful exception messages aimed at other developers. Use correct grammar, spelling, and punctuation. Try to phrase the message in a non-blaming way. Supply information about the context or the offending value. If possible, suggest how to resolve the error.
  </p>
  <p>
    It will take you an extra five minutes to write such an exception message, but will save your colleagues, your clients, and your future self hours of troubleshooting and debugging.
  </p>
</div>